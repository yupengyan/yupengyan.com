<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Joe Yu" />
        <meta name="copyright" content="Joe Yu" />

        <meta name="description" content="删除含有空数据 import pandas as pd # 删除含有空数据的全部行 df4 = pd.read_csv('4.csv',encoding='utf-8') df4 = df4.dropna() # 可以通过axis参数来删除含有空数据的全部列 df4 = df4.dropna(axis=1) # 可以通过subset参数来删除在age和sex中含有空数据的全部行 df4 = df4.dropna(subset=["age", "sex"]) print(df4) df4 = df4.dropna(subset=['age', 'body','home.dest']) df = pd.DataFrame([['GD', 'GX', 'FJ'], ['SD', 'SX', 'BJ'], ['HN', 'HB …
" />
<meta name="keywords" content=", Python, " />
        <title>pandas&nbsp;handhook  · Yu's Blog
</title>
        <!-- link href="http://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css" -->
        <link rel="stylesheet" type="text/css" href="https://yupengyan.com/theme/css/slim-081711.css">
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://yupengyan.com/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://yupengyan.com/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="https://yupengyan.com/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="https://yupengyan.com/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://yupengyan.com/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://yupengyan.com/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://yupengyan.com/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://yupengyan.com/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="https://yupengyan.com/theme/images/apple-touch-icon-144x144.png" />
        <link href="https://yupengyan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Yu's Blog - Full Atom Feed" />
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://yupengyan.com/"><span class=site-name>Yu's Blog</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://yupengyan.com">Home</a></li>
                            <li ><a href="https://yupengyan.com/categories.html">Categories</a></li>
                            <li ><a href="https://yupengyan.com/tags.html">Tags</a></li>
                            <li ><a href="https://yupengyan.com/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="https://yupengyan.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="https://yupengyan.com/pandas-handhook"> pandas&nbsp;handhook  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <blockquote>
<p>删除含有空数据</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="c1"># 删除含有空数据的全部行</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;4.csv&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># 可以通过axis参数来删除含有空数据的全部列</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 可以通过subset参数来删除在age和sex中含有空数据的全部行</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">df4</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">,</span><span class="s1">&#39;home.dest&#39;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;GX&#39;</span><span class="p">,</span> <span class="s1">&#39;FJ&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;SX&#39;</span><span class="p">,</span> <span class="s1">&#39;BJ&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;HN&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span>
   <span class="o">...</span><span class="p">:</span> <span class="p">,</span> <span class="s1">&#39;AH&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;HEN&#39;</span><span class="p">,</span> <span class="s1">&#39;HEN&#39;</span><span class="p">,</span> <span class="s1">&#39;HLJ&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SH&#39;</span><span class="p">,</span> <span class="s1">&#39;TJ&#39;</span><span class="p">,</span> <span class="s1">&#39;CQ&#39;</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2</span>
   <span class="o">...</span><span class="p">:</span> <span class="s1">&#39;, &#39;</span><span class="n">p3</span><span class="s1">&#39;])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
    <span class="n">p1</span>   <span class="n">p2</span>   <span class="n">p3</span>
<span class="mi">0</span>   <span class="n">GD</span>   <span class="n">GX</span>   <span class="n">FJ</span>
<span class="mi">1</span>   <span class="n">SD</span>   <span class="n">SX</span>   <span class="n">BJ</span>
<span class="mi">2</span>   <span class="n">HN</span>   <span class="n">HB</span>   <span class="n">AH</span>
<span class="mi">3</span>  <span class="n">HEN</span>  <span class="n">HEN</span>  <span class="n">HLJ</span>
<span class="mi">4</span>   <span class="n">SH</span>   <span class="n">TJ</span>   <span class="n">CQ</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;HN&#39;</span><span class="p">])]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span>
   <span class="n">p1</span>  <span class="n">p2</span>  <span class="n">p3</span>
<span class="mi">0</span>  <span class="n">GD</span>  <span class="n">GX</span>  <span class="n">FJ</span>
<span class="mi">2</span>  <span class="n">HN</span>  <span class="n">HB</span>  <span class="n">AH</span>
</pre></div>


<p>https://blog.csdn.net/xiaomuworld/article/details/52057804</p>
<p>https://blog.csdn.net/use_my_heart/article/details/52184897</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ExceQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">chunksizes</span><span class="p">):</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">chunksizes</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksizes</span><span class="p">):</span>
            <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">40</span><span class="p">])</span>  <span class="c1"># 在多线程运行后查看是哪个sql语句运行完成了，以便清楚是堵在哪个查询上了</span>
    <span class="k">print</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df_list</span>
</pre></div>


<blockquote>
<p>python lambda&nbsp;使用if</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;big&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="k">else</span> <span class="s1">&#39;small&#39;</span>
<span class="c1"># or</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">][</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">]</span>
</pre></div>


<blockquote>
<p>删除重复数据</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
</pre></div>


<p>其中参数解释如下：
subset：用于识别重复的列标签或列标签序列，默认所有列标签
keep=‘frist’：除了第一次出现外，其余相同的被标记为重复
keep=&#8217;last&#8217;：除了最后一次出现外，其余相同的被标记为重复&nbsp;keep=False：所有相同的都被标记为重复</p>
<p>例子：</p>
<div class="highlight"><pre><span></span><span class="c1">#keep=&#39;first&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="c1">#默认所有列，无重复记录</span>
<span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;col1&#39;</span><span class="p">)</span><span class="c1">#第二、四、五行被标记为重复</span>
<span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">([</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span><span class="s1">&#39;col2&#39;</span><span class="p">])</span><span class="c1">#第五行被标记为重复</span>
<span class="c1">#keep=&#39;last&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span><span class="c1">#第一、三、四行被标记重复</span>
 <span class="sb">``</span><span class="err">`</span>

<span class="o">&gt;</span> <span class="err">求和</span>
 <span class="sb">``</span><span class="err">`</span><span class="n">python</span>
   <span class="c1">#对列求和</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="c1">#对行求和</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>


<blockquote>
<p>统计函数   </p>
</blockquote>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1">#非空元素计算 </span>
<span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="c1">#最小值 </span>
<span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="c1">#最大值 </span>
<span class="n">df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span> <span class="c1">#最小值的位置，类似于R中的which.min函数 </span>
<span class="n">df</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span> <span class="c1">#最大值的位置，类似于R中的which.max函数 </span>
<span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1">#10%分位数 </span>
<span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#求和 </span>
<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#均值 </span>
<span class="n">df</span><span class="o">.</span><span class="n">median</span><span class="p">()</span> <span class="c1">#中位数 </span>
<span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span> <span class="c1">#众数 </span>
<span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="c1">#方差 </span>
<span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="c1">#标准差 </span>
<span class="n">df</span><span class="o">.</span><span class="n">mad</span><span class="p">()</span> <span class="c1">#平均绝对偏差 </span>
<span class="n">df</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span> <span class="c1">#偏度 </span>
<span class="n">df</span><span class="o">.</span><span class="n">kurt</span><span class="p">()</span> <span class="c1">#峰度 </span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1">#一次性输出多个描述性统计指标</span>
</pre></div>


<blockquote>
<p>分组统计  <br />
依托group&nbsp;by,单列如：</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="err">‘</span><span class="n">sex</span><span class="err">’</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  
</pre></div>


<p>通过多个列进行分组形成一个层次索引，然后执行函数：</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="err">‘</span><span class="n">sex</span><span class="err">’</span><span class="p">,</span><span class="err">’</span><span class="n">B</span><span class="err">’</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>    
</pre></div>


<h2 id="apply-and-applymap">apply() and applymap()<a class="headerlink" href="#apply-and-applymap" title="Permanent link">&para;</a></h2>
<p>https://blog.csdn.net/qq_20412595/article/details/81131502 <br />
对DataFrame对象中的某些行或列，或者对DataFrame对象中的所有元素进行某种运算或操作，我们无需利用低效笨拙的循环，
DataFrame给我们分别提供了相应的直接而简单的方法，apply()和applymap()。&nbsp;其中apply()方法是针对某些行或列进行操作的，而applymap()方法则是针对所有元素进行操作的</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wide petal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;petal width&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="mf">1.3</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;petal area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;petal length&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;petal width&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="next_article"><a href="https://yupengyan.com/how-to-build-a-blog-with-pelican" title="Next: How to build a blog with&nbsp;Pelican">How to build a blog with&nbsp;Pelican</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2018-12-03T10:20:00+08:00">12月 3, 2018</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#Python-ref">Python</a> 

            <!-- Begin MailChimp Signup Form -->
            <div id="mc_embed_signup">
                <form action="empty" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                    <h4>Get Monthly Updates</h4>
                    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Enter your email..." required>
                    <div class="clear"><input type="submit" value="Send me Free updates" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </form>
            </div>

            <!--End mc_embed_signup-->
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-license">Elegant theme documentation is licensed under a <a rel="license" 
    href="http://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.</li>
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    </body>
</html>